<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <title>Title</title>
</head>
<body>
<script>
  const varBox = {}
  const fakeWindow = new Proxy(window, {
    get(target, key) {
      return varBox[key] || window[key]
    },
    set(target, key, value) {
      varBox[key] = value
      return true
    }
  })
  const fn = (code) => new Function('window', `with(window){${code}}`)
  fn(`var $CONFIG = { a: true};if($CONFIG.a){console.log(1)}`)(fakeWindow)
</script>

</body>
</html>
