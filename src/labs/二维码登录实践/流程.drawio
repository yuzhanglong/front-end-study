<mxfile host="" modified="2021-01-13T14:33:17.905Z" agent="5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36" etag="L5jriVd8a-DOIOq-Hx4W" version="13.7.9" type="embed"><diagram id="Ed2gfqiH4S2zv9HuBr58" name="Page-1"><mxGraphModel dx="1379" dy="707" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0"><root><mxCell id="0"/><mxCell id="1" parent="0"/><mxCell id="5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#FF0000;" parent="1" source="3" target="4" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="270" y="215" as="sourcePoint"/></mxGeometry></mxCell><mxCell id="40" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="3" target="4"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="3" value="客户端" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="150" y="180" width="110" height="50" as="geometry"/></mxCell><mxCell id="30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=0.75;entryY=1;entryDx=0;entryDy=0;fillColor=#FF6666;strokeColor=#FF0000;" parent="1" source="4" target="3" edge="1"><mxGeometry relative="1" as="geometry"/></mxCell><mxCell id="37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.364;entryY=1;entryDx=0;entryDy=0;entryPerimeter=0;strokeColor=#FF0000;fillColor=#FF6666;" parent="1" source="4" target="3" edge="1"><mxGeometry relative="1" as="geometry"><Array as="points"><mxPoint x="655" y="370"/><mxPoint x="190" y="370"/></Array></mxGeometry></mxCell><mxCell id="38" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;strokeColor=#FF0000;fillColor=#FF6666;" parent="1" source="4" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="163" y="230" as="targetPoint"/><Array as="points"><mxPoint x="665" y="430"/><mxPoint x="163" y="430"/></Array></mxGeometry></mxCell><mxCell id="4" value="服务端" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="640" y="260" width="100" height="50" as="geometry"/></mxCell><mxCell id="6" value="1.用户触发二维码登录界面" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="120" y="150" width="190" height="30" as="geometry"/></mxCell><mxCell id="7" value="2.客户端和服务端建立 websocket 连接" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="340" y="170" width="210" height="30" as="geometry"/></mxCell><mxCell id="12" value="3. 基于 2&amp;nbsp; 的 WebSocket&amp;nbsp; 连接，发送一个唯一的识别码（uuid）" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="340" y="240" width="200" height="30" as="geometry"/></mxCell><mxCell id="16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="4" edge="1"><mxGeometry relative="1" as="geometry"><mxPoint x="260" y="550" as="sourcePoint"/></mxGeometry></mxCell><mxCell id="15" value="移动端" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1"><mxGeometry x="150" y="530" width="110" height="40" as="geometry"/></mxCell><mxCell id="19" value="4. 通过 uuid 向服务端请求一个携带该uuid的二维码，当然，这个二维码也可以在前端生成" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="280" y="300" width="280" height="40" as="geometry"/></mxCell><mxCell id="20" value="8. 用户点击确认按钮，携带 token 和 uuid 以确认扫描用户身份&lt;br&gt;向服务端发送确认请求" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="275" y="550" width="380" height="50" as="geometry"/></mxCell><mxCell id="27" value="6. 服务端通过 websocket 告知客户端二维码已被扫描，客户端告知用户在手机上确认" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="230" y="370" width="360" height="40" as="geometry"/></mxCell><mxCell id="34" value="7. 用户点击客户端的确认按钮，向服务端再次发起请求，由于移动端此时处于登录状态，我们会在移动端携带 token 和 uuid 以确认扫描用户身份" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="270" y="500" width="390" height="40" as="geometry"/></mxCell><mxCell id="39" value="9. 服务端通过 websocket 告知用户已经确认，并提供 &lt;b&gt;token&lt;/b&gt; 给客户端，整个登录过程结束" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1"><mxGeometry x="160" y="430" width="500" height="40" as="geometry"/></mxCell></root></mxGraphModel></diagram></mxfile>